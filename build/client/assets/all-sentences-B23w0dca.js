import{w as H,a,p as e}from"./chunk-EPOLDU6W-Db15p_wQ.js";import{C as J,S as M,G as f,T as O,B as u,P as j,f as Q,a as U,b as T}from"./api-TiMZYRdJ.js";import{h as V,T as i}from"./AuthProvider-B78M3Mu0.js";import{F as X,S as Y}from"./SentenceCard-BtKCukHC.js";import{T as Z}from"./TextInput-DMgR66im.js";import"./index-xUmu4QGa.js";import"./Tooltip-CochBmdA.js";import"./OptionalPortal-CyEJmNpe.js";import"./use-isomorphic-effect-CHtvWNEI.js";function ue({}){return[{title:"All Sentences"}]}const he=H(function(){const[n,m]=a.useState("1"),[o,S]=a.useState([]),[w,h]=a.useState([]),[c,p]=a.useState(0),[ee,te]=a.useState(!0),[F,P]=a.useState(!1),[d,b]=a.useState(null),[l,A]=a.useState(null),[k,I]=a.useState(null),[y,W]=a.useState(""),[B,v]=a.useState(!1),{acquireToken:x}=V();a.useEffect(()=>{(async()=>{try{const s=await x(),r=await Q(s);A(r)}catch(s){console.debug("Could not acquire token for card count",s)}})()},[x]),a.useEffect(()=>{(async()=>{P(!0),I(null);try{const s=await x(),r=await U(n,s);r?b(r):(I("Card not found"),b(null))}catch(s){console.debug("Could not acquire token or fetch phrase",s)}finally{P(!1)}})()},[n]);const N=async t=>{S(t),p(0),v(!0);try{if(d)try{const s=await x(),r=await Promise.all(t.map(g=>T(g,d.Phrase,s)));h(r)}catch(s){console.debug("Could not acquire token for word data",s);const r=await Promise.all(t.map(g=>T(g,d.Phrase)));h(r)}}catch(s){console.error("Failed to fetch word data:",s),h([])}finally{v(!1)}},E=()=>{S([]),h([]),p(0)},G=()=>{c>0&&p(t=>t-1)},q=()=>{c<o.length-1&&p(t=>t+1)},D=c===0,z=c===o.length-1,$=()=>{const t=parseInt(n)-1;t>=1&&m(String(t))},K=()=>{if(!C){const t=parseInt(n)+1;m(String(t))}},R=n==="1",C=l!==null&&parseInt(n)===l,L=()=>{const t=y.trim();if(t&&/^\d+$/.test(t)){const s=parseInt(t);(l===null||s>=1&&s<=l)&&(m(t),W(""))}};return e.jsx(J,{size:"md",className:"pt-16 pb-16",children:e.jsxs(M,{gap:"lg",children:[e.jsxs(f,{justify:"space-between",align:"flex-end",children:[e.jsxs("div",{children:[e.jsx(O,{order:2,children:"All Sentences"}),e.jsx(i,{mt:"sm",c:"dimmed",children:"Select a word from the sentence to create a flashcard"})]}),e.jsxs(f,{gap:"xs",wrap:"nowrap",children:[e.jsx(Z,{placeholder:"Card No",value:y,onChange:t=>W(t.currentTarget.value),onKeyPress:t=>{t.key==="Enter"&&L()},size:"sm",w:80}),e.jsx(u,{onClick:L,variant:"light",size:"sm",children:"Go"})]})]}),F?e.jsx(j,{p:"lg",radius:"md",withBorder:!0,children:e.jsx(i,{children:"Loading card..."})}):k?e.jsx(j,{p:"lg",radius:"md",withBorder:!0,children:e.jsx(i,{c:"red",children:k})}):d?e.jsxs(e.Fragment,{children:[o.length>0?e.jsx(e.Fragment,{children:B?e.jsx(j,{p:"lg",radius:"md",withBorder:!0,children:e.jsx(i,{children:"Creating flashcards..."})}):w.length>0?e.jsxs(e.Fragment,{children:[e.jsx(X,{phrase:d,selectedWord:o[c],wordData:w[c],isLoading:!1,onBack:E}),e.jsxs(f,{justify:"space-between",mt:"xl",children:[e.jsx(u,{variant:"subtle",onClick:G,disabled:D,children:"Previous"}),e.jsxs(i,{c:"dimmed",children:[c+1," / ",o.length]}),e.jsx(u,{variant:"subtle",onClick:q,disabled:z,children:"Next"})]})]}):null}):e.jsx(Y,{phrase:d,onSelectWords:N,selectedWords:o}),o.length===0&&e.jsxs(f,{justify:"space-between",mt:"xl",children:[e.jsx(u,{variant:"subtle",onClick:$,disabled:R,children:"Previous"}),e.jsxs(i,{c:"dimmed",children:[n," ",l!==null?`/ ${l}`:""]}),e.jsx(u,{variant:"subtle",onClick:K,disabled:C,children:C?"Last Card":"Next"})]})]}):null]})})});export{he as default,ue as meta};
