import{w as V,b as r,t as e}from"./index-CWD__XTI.js";import{T as H,S as J,P as h,G as f,f as M,a as O,b as E}from"./api-CO88OdlV.js";import{h as Q,T as i,B as u}from"./AuthProvider-DIbg4P3B.js";import{F as U,S as X}from"./SentenceCard-BMF-z7BU.js";import{T as Y}from"./TextInput-i3HMMitU.js";import"./Tooltip-BmlxqTPC.js";import"./OptionalPortal-CAJ6Pykm.js";import"./use-isomorphic-effect-Chui70N-.js";function ie({}){return[{title:"All Sentences"}]}const ce=V(function(){const[a,p]=r.useState("1"),[n,b]=r.useState([]),[y,m]=r.useState([]),[o,x]=r.useState(0),[_,ee]=r.useState(!0),[z,C]=r.useState(!1),[c,S]=r.useState(null),[l,G]=r.useState(null),[v,N]=r.useState(null),[k,P]=r.useState(""),[B,I]=r.useState(!1),{acquireToken:g}=Q();r.useEffect(()=>{(async()=>{try{const t=await g(),d=await M(t);G(d)}catch(t){console.debug("Could not acquire token for card count",t)}})()},[g]),r.useEffect(()=>{(async()=>{C(!0),N(null);try{const t=await g(),d=await O(a,t);d?S(d):(N("Card not found"),S(null))}catch(t){console.debug("Could not acquire token or fetch phrase",t)}finally{C(!1)}})()},[a]),r.useEffect(()=>{const s=t=>{t.key==="ArrowLeft"?n.length>0?L():T():t.key==="ArrowRight"&&(n.length>0?W():F())};return window.addEventListener("keydown",s),()=>window.removeEventListener("keydown",s)},[n.length,o,a,l]);const q=async s=>{b(s),x(0),I(!0);try{if(c)try{const t=await g(),d=await Promise.all(s.map(w=>E(w,c.Phrase,t,!1)));m(d)}catch(t){console.debug("Could not acquire token for word data",t);const d=await Promise.all(s.map(w=>E(w,c.Phrase,void 0,!1)));m(d)}}catch(t){console.error("Failed to fetch word data:",t),m([])}finally{I(!1)}},D=()=>{b([]),m([]),x(0)},L=()=>{o>0&&x(s=>s-1)},W=()=>{o<n.length-1&&x(s=>s+1)},K=o===0,R=o===n.length-1,T=()=>{const s=parseInt(a)-1;s>=1&&p(String(s))},F=()=>{if(!j){const s=parseInt(a)+1;p(String(s))}},$=a==="1",j=l!==null&&parseInt(a)===l,A=()=>{const s=k.trim();if(s&&/^\d+$/.test(s)){const t=parseInt(s);(l===null||t>=1&&t<=l)&&(p(s),P(""))}};return e.jsxs("div",{children:[e.jsxs("div",{className:"mb-8",children:[e.jsx(H,{order:1,className:"text-3xl font-bold text-gray-900 mb-2",children:"All Sentences"}),e.jsx(i,{c:"dimmed",size:"lg",children:"Select words from sentences to create flashcards"})]}),e.jsxs(J,{gap:"xl",children:[e.jsx(h,{p:"md",className:"bg-white border border-gray-200 shadow-sm",radius:"lg",children:e.jsxs(f,{justify:"space-between",align:"center",children:[e.jsxs(i,{size:"sm",c:"dimmed",className:"flex items-center gap-2",children:[e.jsx("span",{children:"üìä"}),l!==null?e.jsxs(e.Fragment,{children:["Viewing card ",e.jsx("strong",{children:a})," of ",e.jsx("strong",{children:l})]}):e.jsxs(e.Fragment,{children:["Card ",e.jsx("strong",{children:a})]})]}),e.jsxs(f,{gap:"xs",wrap:"nowrap",children:[e.jsx(Y,{placeholder:"Go to card...",value:k,onChange:s=>P(s.currentTarget.value),onKeyPress:s=>{s.key==="Enter"&&A()},size:"sm",w:120,className:"transition-all focus-within:shadow-sm"}),e.jsx(u,{onClick:A,variant:"light",size:"sm",className:"hover:shadow-sm transition-all",children:"Go"})]})]})}),z?e.jsx(h,{p:"xl",radius:"lg",shadow:"sm",className:"bg-white border border-gray-100",children:e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(i,{c:"dimmed",children:"Loading card..."})})}):v?e.jsx(h,{p:"xl",radius:"lg",shadow:"sm",className:"bg-white border border-red-100",children:e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(i,{c:"red",fw:500,children:v})})}):c?e.jsxs(e.Fragment,{children:[n.length>0?e.jsx(e.Fragment,{children:B?e.jsx(h,{p:"xl",radius:"lg",shadow:"sm",className:"bg-white border border-gray-100",children:e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(i,{c:"dimmed",children:"Creating flashcards..."})})}):y.length>0?e.jsxs(e.Fragment,{children:[e.jsx(U,{phrase:c,selectedWord:n[o],wordData:y[o],isLoading:!1,onBack:D}),e.jsx(h,{p:"md",className:"bg-white border border-gray-200 shadow-sm",radius:"lg",children:e.jsxs(f,{justify:"space-between",children:[e.jsx(u,{variant:"light",onClick:L,disabled:K,leftSection:e.jsx("span",{children:"‚Üê"}),className:"hover:shadow-sm transition-all",children:"Previous Word"}),e.jsx("div",{className:"px-4 py-2 bg-blue-50 rounded-full",children:e.jsxs(i,{size:"sm",fw:600,c:"blue.7",children:[o+1," / ",n.length]})}),e.jsx(u,{variant:"light",onClick:W,disabled:R,rightSection:e.jsx("span",{children:"‚Üí"}),className:"hover:shadow-sm transition-all",children:"Next Word"})]})})]}):null}):e.jsx(X,{phrase:c,onSelectWords:q,selectedWords:n}),n.length===0&&e.jsx(h,{p:"md",className:"bg-white border border-gray-200 shadow-sm",radius:"lg",children:e.jsxs(f,{justify:"space-between",children:[e.jsx(u,{variant:"light",onClick:T,disabled:$,leftSection:e.jsx("span",{children:"‚Üê"}),className:"hover:shadow-sm transition-all",children:"Previous"}),e.jsx("div",{className:"px-4 py-2 bg-gray-100 rounded-full",children:e.jsxs(i,{size:"sm",fw:600,c:"gray.7",children:["Card ",a," ",l!==null?`/ ${l}`:""]})}),e.jsx(u,{variant:"light",onClick:F,disabled:j,rightSection:e.jsx("span",{children:"‚Üí"}),className:"hover:shadow-sm transition-all",children:j?"Last Card":"Next"})]})})]}):null]})]})});export{ce as default,ie as meta};
