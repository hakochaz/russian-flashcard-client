import{w as z,b as i,t as e}from"./index-CWD__XTI.js";import{S as D,T as U,G as w,P as v,d as W,g as k,b as y}from"./api-CO88OdlV.js";import{h as N,T as f,B as P}from"./AuthProvider-DIbg4P3B.js";import{F as G,S as R}from"./SentenceCard-BMF-z7BU.js";import{C as q}from"./Container-D1gD7sw9.js";import{T as K}from"./TextInput-i3HMMitU.js";import"./Tooltip-BmlxqTPC.js";import"./OptionalPortal-CAJ6Pykm.js";import"./use-isomorphic-effect-Chui70N-.js";function $({}){return[{title:"Create Sentence Card"}]}const ee=z(function(){const[S,A]=i.useState(""),[r,c]=i.useState(null),[n,h]=i.useState([]),[g,d]=i.useState([]),[o,l]=i.useState(0),[T,p]=i.useState(!1),{acquireToken:F}=N();i.useEffect(()=>{const s=a=>{n.length>0&&(a.key==="ArrowLeft"?j():a.key==="ArrowRight"&&C())};return window.addEventListener("keydown",s),()=>window.removeEventListener("keydown",s)},[n.length,o]);const L=()=>{c({CardId:"0",Phrase:S,PhraseStress:"",Audio:"",Translation:""}),h([]),d([]),l(0)},b=async s=>{h(s),l(0),p(!0);try{if(r)try{const a=await F(),[u,m,x]=await Promise.all([Promise.all(s.map(t=>y(t,r.Phrase,a))),W(r.Phrase,a),k(r.Phrase,a)]);d(u),c(t=>t&&{...t,Audio:m||t.Audio,PhraseStress:x||t.Phrase})}catch{const[u,m,x]=await Promise.all([Promise.all(s.map(t=>y(t,r.Phrase))),W(r.Phrase),k(r.Phrase)]);d(u),c(t=>t&&{...t,Audio:m||t.Audio,PhraseStress:x||t.Phrase})}}catch(a){console.error("Failed to fetch word data:",a),d([])}finally{p(!1)}},E=()=>{h([]),d([]),l(0)},j=()=>{o>0&&l(s=>s-1)},C=()=>{o<n.length-1&&l(s=>s+1)},I=o===0,B=o===n.length-1;return e.jsx(q,{size:"md",className:"pt-16 pb-16",children:e.jsxs(D,{gap:"lg",children:[e.jsxs("div",{children:[e.jsx(U,{order:2,children:"Create Sentence Cards"}),e.jsx(f,{mt:"sm",c:"dimmed",children:"Enter a sentence and select words to create flashcards"}),e.jsxs(w,{mt:"md",align:"center",children:[e.jsx(K,{placeholder:"Enter sentence",value:S,onChange:s=>A(s.currentTarget.value),size:"md",style:{flex:1}}),e.jsx(P,{onClick:L,variant:"light",size:"sm",ml:"sm",children:"Use"})]})]}),r?e.jsx(e.Fragment,{children:n.length>0?e.jsx(e.Fragment,{children:T?e.jsx(v,{p:"lg",radius:"md",withBorder:!0,children:e.jsx(f,{children:"Creating flashcards..."})}):g.length>0?e.jsxs(e.Fragment,{children:[e.jsx(G,{phrase:r,selectedWord:n[o],wordData:g[o],isLoading:!1,onBack:E}),e.jsxs(w,{justify:"space-between",mt:"xl",children:[e.jsx(P,{variant:"subtle",onClick:j,disabled:I,children:"Previous"}),e.jsxs(f,{c:"dimmed",children:[o+1," / ",n.length]}),e.jsx(P,{variant:"subtle",onClick:C,disabled:B,children:"Next"})]})]}):null}):e.jsx(R,{phrase:r,onSelectWords:b,selectedWords:n})}):null]})})});export{ee as default,$ as meta};
