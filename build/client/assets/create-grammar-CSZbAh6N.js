import{w as F,a as u,p as e}from"./chunk-EPOLDU6W-Db15p_wQ.js";import{C as E,S as f,T as W,G as c,B as p,P as h,A as w,e as k,d as A}from"./api-TiMZYRdJ.js";import{h as R,T as o}from"./AuthProvider-B78M3Mu0.js";import{T as D}from"./TextInput-DMgR66im.js";import{C,T as y}from"./Tooltip-CochBmdA.js";import"./index-xUmu4QGa.js";import"./use-isomorphic-effect-CHtvWNEI.js";import"./OptionalPortal-CyEJmNpe.js";function O({}){return[{title:"Create Grammar Cards"}]}const Q=F(function(){const[d,v]=u.useState(""),[g,T]=u.useState([]),[m,j]=u.useState([]),[i,x]=u.useState(null),[z,b]=u.useState(!1),{acquireToken:P}=R(),B=()=>{const s=d.split(/\s+/).filter(r=>r.length>0);T(s),j([]),x(null)},G=s=>{j(r=>{if(r.includes(s))return r.filter(a=>a!==s);if(r.length===0)return[s];{const a=Math.min(...r),n=Math.max(...r);return s===a-1||s===n+1?[...r,s].sort((t,l)=>t-l):s>a&&s<n?[...r,s].sort((t,l)=>t-l):[s]}})},S=()=>{if(m.length===0)return!0;const s=[...m].sort((r,a)=>r-a);for(let r=1;r<s.length;r++)if(s[r]!==s[r-1]+1)return!1;return!0},I=async()=>{if(!S()){alert("Please select only consecutive words");return}const a=[...m].sort((n,t)=>n-t).map(n=>g[n]).join(" ").replace(/[?!.,;:]+$/,"");b(!0);try{const n=await P(),[t,l]=await Promise.all([k(d,a,n),A(d,n)]);t&&l&&x({phraseAnswer:t.phraseAnswer,bracketedSentence:t.bracketedSentence,audioUrl:l})}catch{try{const[t,l]=await Promise.all([k(d,a),A(d)]);t&&l&&x({phraseAnswer:t.phraseAnswer,bracketedSentence:t.bracketedSentence,audioUrl:l})}catch(t){console.error("Failed to create grammar flashcard:",t),alert("Failed to create flashcard. Please try again.")}}finally{b(!1)}},U=()=>{x(null),j([])};return e.jsx(E,{size:"md",className:"pt-16 pb-16",children:e.jsxs(f,{gap:"lg",children:[e.jsxs("div",{children:[e.jsx(W,{order:2,children:"Create Grammar Cards"}),e.jsx(o,{mt:"sm",c:"dimmed",children:"Enter a sentence and select consecutive words to create a grammar flashcard"}),e.jsxs(c,{mt:"md",align:"center",children:[e.jsx(D,{placeholder:"Enter sentence",value:d,onChange:s=>v(s.currentTarget.value),size:"md",style:{flex:1}}),e.jsx(p,{onClick:B,variant:"light",size:"sm",ml:"sm",children:"Use"})]})]}),g.length>0&&!i&&e.jsx(h,{p:"lg",radius:"md",withBorder:!0,children:e.jsxs(f,{gap:"md",children:[e.jsxs("div",{children:[e.jsx(o,{size:"sm",c:"dimmed",mb:"md",children:"Click on consecutive words to select them:"}),e.jsx(h,{p:"md",bg:"gray.0",radius:"sm",style:{lineHeight:1.8,minHeight:"80px",display:"flex",alignItems:"center"},children:e.jsx(c,{gap:"xs",wrap:"wrap",children:g.map((s,r)=>e.jsx(p,{variant:m.includes(r)?"filled":"light",size:"sm",onClick:()=>G(r),style:{cursor:"pointer"},children:s},r))})})]}),m.length>0&&e.jsxs(c,{justify:"flex-end",children:[e.jsx(p,{variant:"light",onClick:()=>j([]),children:"Clear Selection"}),e.jsx(p,{onClick:I,loading:z,disabled:!S(),children:"Create Flashcard"})]})]})}),i&&e.jsx(h,{p:"lg",radius:"md",withBorder:!0,children:e.jsxs(f,{gap:"md",children:[e.jsx(c,{justify:"space-between",align:"center",children:e.jsx(p,{variant:"subtle",onClick:U,children:"â† Create Another"})}),e.jsxs("div",{children:[e.jsx(o,{size:"sm",c:"dimmed",mb:"xs",children:"Bracketed Sentence:"}),e.jsx(h,{p:"md",bg:"gray.0",radius:"sm",children:e.jsxs(c,{justify:"space-between",align:"center",children:[e.jsx(o,{fw:500,children:i.bracketedSentence}),e.jsx(C,{value:i.bracketedSentence,children:({copied:s,copy:r})=>e.jsx(y,{label:s?"Copied":"Copy",withArrow:!0,position:"left",children:e.jsx(w,{color:s?"teal":"gray",variant:"subtle",onClick:r,children:s?"âœ“":"ðŸ“‹"})})})]})})]}),e.jsxs("div",{children:[e.jsx(o,{size:"sm",c:"dimmed",mb:"xs",children:"Phrase Answer:"}),e.jsx(h,{p:"md",bg:"gray.0",radius:"sm",children:e.jsxs(c,{justify:"space-between",align:"center",children:[e.jsx(o,{fw:500,children:i.phraseAnswer}),e.jsx(C,{value:i.phraseAnswer,children:({copied:s,copy:r})=>e.jsx(y,{label:s?"Copied":"Copy",withArrow:!0,position:"left",children:e.jsx(w,{color:s?"teal":"gray",variant:"subtle",onClick:r,children:s?"âœ“":"ðŸ“‹"})})})]})})]}),e.jsxs("div",{children:[e.jsx(o,{size:"sm",c:"dimmed",mb:"xs",children:"Audio:"}),e.jsx(h,{p:"md",bg:"gray.0",radius:"sm",children:e.jsxs(c,{justify:"space-between",align:"center",wrap:"nowrap",children:[e.jsxs("audio",{controls:!0,style:{flex:1},children:[e.jsx("source",{src:i.audioUrl,type:"audio/mpeg"}),"Your browser does not support the audio element."]}),e.jsx(C,{value:i.audioUrl,children:({copied:s,copy:r})=>e.jsx(y,{label:s?"Copied":"Copy",withArrow:!0,position:"left",children:e.jsx(w,{color:s?"teal":"gray",variant:"subtle",onClick:r,children:s?"âœ“":"ðŸ“‹"})})})]})})]})]})})]})})});export{Q as default,O as meta};
